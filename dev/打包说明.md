# 运输协议邮件外发 — 打包说明

本文说明如何将本项目打包为可在**未安装 Python** 的电脑上运行的独立程序，以及打包后的使用方式。脚本与文档均在 **dev** 目录下，项目根目录仅保留用户维护的 **EmailAddress.csv**。

---

## 一、项目目录结构

- **项目根目录（TransportAgreement）**：用户只需维护 **EmailAddress.csv**；运行或打包时作为“工作根目录”（配置、签名、日志、项目文件夹均在此目录下生成或选择）。
- **dev/**：所有脚本、配置模板与文档，用户无需关注。打包时在**项目根目录**下执行 `dev\build_gui.bat`。

---

## 二、打包内容与入口

- **打包入口**：dev 目录下的 **gui.py**，打包后得到 **TransportAgreement_GUI.exe**。
- **功能**：通过 GUI 维护 SMTP 账号密码、邮件签名、创建项目文件夹、查看日志并**开始批量发送**（内部调用 send_emails_smtp.py）。

---

## 三、打包环境准备

1. 安装 Python 3.8+（仅打包时需要）。
2. 安装 PyInstaller：
   ```bash
   pip install -r dev/requirements-dev.txt
   ```
   或：`pip install pyinstaller`

---

## 四、打包步骤（Windows）

在**项目根目录**下执行：

```batch
dev\build_gui.bat
```

脚本会自动回到项目根目录并执行打包，将 **dev/gui.py** 与 **dev/send_emails_smtp.py** 一并打包。完成后可执行文件路径：`dist\TransportAgreement_GUI\TransportAgreement_GUI.exe`。

---

## 五、在未安装 Python 的电脑上使用

1. **拷贝**：将 `dist\TransportAgreement_GUI` 整个文件夹复制到目标电脑。
2. **放置数据**：将 **EmailAddress.csv** 放在 exe 所在目录（或通过 GUI 选择其他工作根目录）；smtp_config.ini、Signature.txt 可由 GUI 首次保存时自动生成在该目录。
3. **运行**：**双击 TransportAgreement_GUI.exe** 即可使用，无需安装 Python。

---

## 六、开发时运行方式

在项目根目录下执行：

```bash
python dev/gui.py
```

工作根目录默认为项目根目录，请确保根目录下有 **EmailAddress.csv**。

---

## 七、GUI 功能简述

| 功能             | 说明                                                   |
| ---------------- | ------------------------------------------------------ |
| **SMTP 账号**    | 维护 smtp_config.ini 的 username、password。           |
| **邮件签名**     | 编辑并保存 Signature.txt。                             |
| **项目管理**     | 勾选要外发的项目、新建项目文件夹；创建后自动刷新列表。 |
| **日志**         | 查看 email_smtp_log.log。                              |
| **开始批量发送** | 对勾选项目执行批量发送，附进度条与预估剩余时间。       |

本文档位于 dev 目录；需求详见 **需求文档\_SMTP版.md**。
